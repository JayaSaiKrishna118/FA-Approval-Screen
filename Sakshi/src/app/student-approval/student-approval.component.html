<div class="row">
  <div class="col-md-3">
    <div class="card" style="min-height: 400px;">
      <div class="card-body">
        <div ngbAccordion>
          <div ngbAccordionItem class="my-3">
            <h2 ngbAccordionHeader>
              <button ngbAccordionButton class="bg-primary text-white"> <i class="fa fa-thumbs-down"></i>&nbsp; &nbsp; At Risk</button>
            </h2>
           
            <div ngbAccordionCollapse>
              <div ngbAccordionBody>
                <ng-template>
                  @for (student of atRisk; track student.rollNo) {
                  <ul class="list-group">
                    <li class="list-group-item">{{ student.rollNo }}</li>
                  </ul>
                  }
                </ng-template>
              </div>
            </div>
          </div>

          <div ngbAccordionItem>
            <h2 ngbAccordionHeader>
              <button ngbAccordionButton class="bg-primary text-white "><i class="fa fa-thumbs-up"></i>&nbsp; &nbsp;Not At Risk</button>
            </h2>
            <div ngbAccordionCollapse>
              <div ngbAccordionBody>
                <ng-template>
                  @for (student of notAtRisk; track student.rollNo) {
                    
                  <ul class="list-group">
                    <li class="list-group-item">{{ student.rollNo }}</li>
                  </ul>
                  }
                </ng-template>

                <button class="btn btn-primary" id="approveAll" (click)="approveAll()">
                  Approve All
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-9">
    <div class="card" style="min-height: 400px;">
      <div class="card-body">
        <div class="container-fluid">
         
          <input
            id="typeahead-focus"
            type="text" placeholder="Search..."
            class="form-control "
            [(ngModel)]="model" [resultTemplate]="rt" [inputFormatter] = "formatter"
            [ngbTypeahead]="search"
            (focus)="focus$.next($any($event).target.value)"
            (click)="click$.next($any($event).target.value)"
            #instance="ngbTypeahead"
          />

          <!--DISPLAY SEARCH RESULTS-->
          <ng-template #rt let-r="result" let-t="term">
            <div
              class="d-flex flex-wrap justify-content-between align-items-center border-bottom py-2 w-100 min-height"
              style="cursor: pointer"
              [routerLink]="['/student-approval', r.rollNo]"
            >
              <div class="col-auto">
                <span class="text-decoration-none mx-2">{{
                  r.rollNo
                }}</span>
              </div>
              <div class="col">
                <span class="d-block">{{ r.name }}</span>
              </div>
            </div>
          </ng-template>
        </div>
        <div class="container-fluid">
          @if(filteredStudent.rollNo){
            <div class="card shadow-sm">
              <div class="card-body">
                <div>
                  <div>
                    Rollno: <span>{{ filteredStudent.rollNo }}</span>
                  </div>
                  <div>
                    Name: <span>{{ filteredStudent.name }}</span>
                  </div>
                  <div>
                    Program: <span>{{ filteredStudent.program }}</span>
                  </div>
                </div>
              </div>
            
              <div class="mt-3">
                <div class="row">
                  <div class="card-body col-md-6">
                    <div ngbAccordion>
                      <div ngbAccordionItem>
                        <h2 ngbAccordionHeader>
                          <button ngbAccordionButton>Core Courses</button>
                        </h2>
                        <div ngbAccordionCollapse>
                          <div ngbAccordionBody>
                            <ng-template>
                              <table class="table table-sm table-striped">
                                <thead>
                                  <tr>
                                    <th>Code</th>
                                    <th>Name</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  @for (course of filteredStudent.coreCourses; track
                                  course.code) {
            
                                  <tr>
                                    <td>{{ course.code }}</td>
                                    <td>{{ course.name }}</td>
                                  </tr>
                                  }
                                </tbody>
                              </table>
                            </ng-template>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="card-body col-md-6">
                    <div ngbAccordion>
                      <div ngbAccordionItem>
                        <h2 ngbAccordionHeader>
                          <button ngbAccordionButton>Elective Credits</button>
                        </h2>
                        <div ngbAccordionCollapse>
                          <div ngbAccordionBody>
                            <ng-template>
                              <table class="table table-sm table-striped">
                                <thead>
                                  <tr>
                                    <th>Code</th>
                                    <th>Min</th>
                                    <th>Max</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  @for (elective of filteredStudent.electiveCredits; track
                                  elective.code) {
                                  <tr>
                                    <td>{{ elective.code }}</td>
                                    <td>{{ elective.min }}</td>
                                    <td>{{ elective.max }}</td>
                                  </tr>
                                  }
                                </tbody>
                              </table>
                            </ng-template>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
            
                <div class="card-body">
                  <h5>Risk Description: </h5>
                 <span>&nbsp;{{ filteredStudent.riskDecs }}</span>
                </div>
                
                <div class="card-body">
                  <div class="mt-1">
                    <div class="row">
                      <div class="col-md-6 d-flex gap-5 align-items-center">
                        @if(filteredStudent?.approvalStatus == ApprovalStatus.PENDING){
                        <button class="btn btn-success" (click)="approveStudent()">Approve</button>
                        <button class="btn btn-danger" (click)="rejectStudent()">Reject</button>
                        }
                      </div>
                    </div>
                  </div>
                </div>
            </div>
      
        </div>
      }
      </div>
    </div>
  </div>
</div>
